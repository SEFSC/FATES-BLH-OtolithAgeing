---
title: Using the Model
subtitle: Predicting the ages of a set of menhaden scale images
metadata-files:
  - ../../_metadata.yml
order: 3
---

Running the Menhaden Ageing Model is straightforward and only requires one command. You will, however, need to modify a `configurations.yml` file. This is explained in more detail below.

### Configuration File

A `configurations.yml` file is an easy way to control model performance. The most important settings in this file to pay attention to are:

1. The directory containing the scale images to process
2. The directory where you want the model output file to be written
3. The directory containing the trained model weights (*i.e.*, the `best_model.pth` file) and, if desired, the Segment Anything Model weights. If you simply cloned the repo and have not moved anything around, the trained model weights file will be alongside the model script in the `scripts` subdirectory in the cloned repository. The SAM weights will be wherever you saved them upon [downloading them](setup.qmd#clone-the-repository).

Absolute file paths are recommended...

*To be continued.*

### Running the model

First we need to activate the virtual environment we [previously configured](setup.qmd#create-a-virtual-environment). In a terminal window, type:

```bash
conda activate scaleageing
```

:::{.callout-tip}
If you named your virtual environment something other than "scaleageing", invoke that name instead.
:::

Navigate into the directory containing the `Scale_Aging_Inference_Script_Image_Only.py` script. If you simply cloned the repo and have not moved anything around, this will in the `scripts` subdirectory in the cloned repository.

Run the model as described in the [usage instructions](../../index.qmd#usage):

```bash
python Scale_Aging_Inference_Script_Image_Only.py <img_dir> <csv_dir> <model_dir>
```

where `<img_dir>` is the full path to the directory containing the scale images to process (#1 above), `<csv_dir>` is the full path to desired directory to which the CSV output will be written  (#2 above), and `<model_dir>` is the full path to the directory containing the `best_model.pth` model weights (#3 above).

### An Example

Directories are handled slightly differently in DOS (Windows Command Prompt, Powershell) than UNIX (Git Bash). For example, running on the Advanced Technology GPU machine might to process 2024 menhaden data might look like this:

#### Git Bash

```bash
python Scale_Aging_Inference_Script_Image_Only.py "G:/Shared drives/NMFS SEFSC FATES Advanced Technology/BIOLOGY_LIFE_HISTORY_DATA/Atlantic menhaden to be tested w active learning/subset" "G:/Shared drives/NMFS SEFSC FATES Advanced Technology/BIOLOGY_LIFE_HISTORY_DATA/Atlantic menhaden to be tested w active learning/model_age_predictions" "C:/Users/user.name/Documents/GitHubRepos/FATES-BLH-ScaleAgeing/scripts"
```

#### Command Prompt

```dosbat
python Scale_Aging_Inference_Script_Image_Only.py “G:\Shared drives\NMFS SEFSC FATES Advanced Technology\BIOLOGY_LIFE_HISTORY_DATA\Atlantic menhaden to be tested w active learning\subset” “C:\Shared drives\NMFS SEFSC FATES Advanced Technology\BIOLOGY_LIFE_HISTORY_DATA\Atlantic menhaden to be tested w active learning\model_age_predictions” “C:\Users\user.name\Documents\GitHubRepos\FATES-BLH-ScaleAgeing\scripts”
```